<!DOCTYPE html>

<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name='viewport' content='width=device-width, initial-scale=1' />

<link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
{#<link href="./css/teacher_home.css" rel="stylesheet">#}
<link href={{ url_for('main_page.static',filename='css/teacher_home.css') }} rel="stylesheet">

<title>教师主页</title>
</head>

<body data-spy="scroll" data-target="#myScrollspy">
<div class="container">
	<div class="jumbotron">
        <h1>教师个人主页</h1>
    </div>
    <div class="row">
        <div class="col-xs-3" id="myScrollspy">
            <ul class="nav nav-tabs nav-stacked" data-spy="affix" data-offset-top="125">
                <li class="active"><a href="#section-1">人员名单</a></li>
                <li><a href="#section-2">到课率折线图</a></li>
                <li><a href="#section-3">未签到人员名单</a></li>
                <li><a href="#section-4">更多</a></li>
            </ul>
        </div>
        <div class="col-xs-9">
            <h2 id="section-1" style='display:inline;'>人员名单</h2>
            <button class='btn btn-default' id='all-refresh'><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button>
            <div>
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>姓名</th>
                            <th>姓名</th>
                            <th>姓名</th>
                            <th>姓名</th>
                            <th>姓名</th>
                            <th>姓名</th>
                            <th>姓名</th>
                            <th>姓名</th>
                            <th>姓名</th>
                            <th>姓名</th>
                        </tr>
                    </thead>
                    <tbody id='all-list'>
                    </tbody>
                </table>
            </div>
            <hr />
            <h2 id="section-2">到课率折线图</h2>
            <div>
            </div>
            <hr />
            <h2 id="section-3" style='display:inline;'>未签到人员名单</h2>
            <button class='btn btn-default' id='no-refresh'><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button>
            <div>
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>姓名</th>
                            <th>到课情况</th>
                        </tr>
                    </thead>
                    <tbody id='no-list'>
                    </tbody>
                </table>
            </div>
            <hr />
            <h2 id="section-4">更多</h2>
            <div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src='https://cdn.bootcss.com/Chart.js/2.5.0/Chart.js'></script>
<script>
    var object_js;
    var s=new Array();
    s.push('success');
    s.push('danger');
    var allList=document.getElementById('all-list');
    
    var object_no={names:null,statuses:null};
    var noList=document.getElementById('no-list');
    

    function getAllList_js(){
{#        var object_js={"张三":0,'李四':1,'王五':0};#}
{#        var object_js = {{ dic_all_students }};#}
         var object_js = {{ dic_all_students|tojson }};
{#        object_js = eval("(" + object_js + ")");#}
        return object_js;
    }
    
    function showAllList_js(){
        object_js=getAllList_js();
        $('#all-list tr').remove();
        var size=0,key;
        var statuses=new Array();
        var names=new Array();
        var tds=new Array(10);
        for(key in object_js){
            if(object_js.hasOwnProperty(key)){
                names.push(key);
                statuses.push(object_js[key]);
                size++;
            }
        }
        var i=0;
        for(i=0;i<size;){
            var tr=document.createElement('tr');
            do{
                if(i>=size){
                    break;
                }
                tds[i%10]=document.createElement('td');
                tds[i%10].innerHTML=names[i];
                $(tds[i%10]).addClass(s[statuses[i]]);
                tr.appendChild(tds[i%10]);
                i++;
            }while(i%10!=0);
            allList.appendChild(tr);
        }
    }
    
    
    showAllList_js();
    
    setInterval('showAllList_js()',60000);
    
    function getNoList(){
        var status=['success','danger'];
        var name=['小明','小王','小李','小明','小王'];
        var object_no={names:name,statuses:status};
        return object_no;
    }
    
    function showNoList(){
        object_no=getNoList();
        $('#no-list tr').remove();
        var length=object_no.names.length-1;
        for(var i=0;i<object_no.names.length;i++){
            var tr=document.createElement('tr');
            var td1=document.createElement('td');
            var td2=document.createElement('td');
            $(tr).addClass('danger');
            td1.innerHTML=object_no.names[Math.round(Math.random()*length)];
            td2.innerHTML='未签到';
            tr.appendChild(td1);
            tr.appendChild(td2);
            noList.appendChild(tr);
        }
    }
    
    showNoList();
    
    setInterval('showNoList()',60000);
    
    var allRefresh=$('#all-refresh');
    var noRefresh=$('#no-refresh');
    allRefresh.click(function(){showAllList();});
    noRefresh.click(function(){showNoList();});
    setInterval(function () {
        $.get('/main_page/data').done(showAllList_js());
        }, 3000);
</script>

</body>

</html>